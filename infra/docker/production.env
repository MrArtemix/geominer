# =============================================================
# Ge O'Miner - Configuration Production
# SLA et performances cibles
# =============================================================

# --- SLA Targets ---
# Disponibilite : 99.9% (8.76h downtime/an max)
# Temps reponse dashboard : < 2s (p95)
# Temps analyse IA : < 30s (p95)
# Capacite : 1M utilisateurs concurrents
SLA_AVAILABILITY_TARGET=99.9
SLA_DASHBOARD_RESPONSE_MS=2000
SLA_ANALYSIS_RESPONSE_MS=30000
SLA_MAX_CONCURRENT_USERS=1000000

# --- PostgreSQL / TimescaleDB (Production) ---
POSTGRES_USER=geominer
POSTGRES_PASSWORD=${VAULT_POSTGRES_PASSWORD}
POSTGRES_DB=geominerdb
POSTGRES_PORT=5432
POSTGRES_MULTIPLE_DATABASES=geominerdb,keycloakdb,mlflowdb
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_SHARED_BUFFERS=2GB
POSTGRES_EFFECTIVE_CACHE_SIZE=6GB
POSTGRES_WORK_MEM=64MB
POSTGRES_MAINTENANCE_WORK_MEM=512MB

# --- Redis (Production) ---
REDIS_PASSWORD=${VAULT_REDIS_PASSWORD}
REDIS_PORT=6379
REDIS_MAXMEMORY=2gb
REDIS_MAXMEMORY_POLICY=allkeys-lru
REDIS_SAVE=900 1 300 10 60 10000

# --- MinIO (Production) ---
MINIO_ROOT_USER=${VAULT_MINIO_USER}
MINIO_ROOT_PASSWORD=${VAULT_MINIO_PASSWORD}
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_SECURE=true

# --- Keycloak (Production) ---
KEYCLOAK_ADMIN=${VAULT_KEYCLOAK_ADMIN}
KEYCLOAK_ADMIN_PASSWORD=${VAULT_KEYCLOAK_PASSWORD}
KEYCLOAK_PORT=8080
KEYCLOAK_REALM=geominer
KEYCLOAK_URL=https://auth.geominer.ci
KEYCLOAK_CLIENT_ID=geominer-api
KEYCLOAK_CLIENT_SECRET=${VAULT_KEYCLOAK_CLIENT_SECRET}
KC_HOSTNAME=auth.geominer.ci
KC_PROXY=edge

# --- MQTT (Production) ---
MQTT_PORT=8883
MQTT_WS_PORT=9883
MQTT_BROKER=mosquitto
MQTT_USE_TLS=true

# --- Prefect (Production) ---
PREFECT_PORT=4200
PREFECT_API_URL=http://prefect-server:4200/api

# --- MLflow (Production) ---
MLFLOW_PORT=5000
MLFLOW_TRACKING_URI=http://mlflow:5000
MLFLOW_MODEL_NAME=MineSpotSegFormer
MLFLOW_MODEL_STAGE=Production

# --- API Gateway (Production) ---
API_GATEWAY_PORT=8000
API_GATEWAY_HOST=0.0.0.0
RATE_LIMIT=500/minute
CORS_ORIGINS=https://app.geominer.ci,https://admin.geominer.ci
DEBUG=false

# --- MineSpot AI Service (Production) ---
MINESPOTAI_PORT=8001
MINESPOTAI_HOST=0.0.0.0
MINESPOT_DEVICE=cuda
MINESPOT_BATCH_SIZE=8
MINESPOT_WORKERS=4

# --- AlertFlow Service (Production) ---
ALERTFLOW_PORT=8002

# --- AquaGuard Service (Production) ---
AQUAGUARD_PORT=8003

# --- GoldTrack Service (Production) ---
GOLDTRACK_PORT=8004

# --- LegalVault Service (Production) ---
LEGALVAULT_PORT=8005

# --- URLs derivees (Production) ---
DATABASE_URL=postgresql://geominer:${VAULT_POSTGRES_PASSWORD}@postgres:5432/geominerdb
REDIS_URL=redis://:${VAULT_REDIS_PASSWORD}@redis:6379/0
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=${VAULT_MINIO_USER}
MINIO_SECRET_KEY=${VAULT_MINIO_PASSWORD}

# --- Monitoring (Production) ---
PROMETHEUS_ENABLED=true
GRAFANA_ADMIN_PASSWORD=${VAULT_GRAFANA_PASSWORD}
ALERTMANAGER_SLACK_WEBHOOK=${VAULT_SLACK_WEBHOOK}

# --- Feature Flags (Production) ---
USE_MOCK_BLOCKCHAIN=false
USE_IPFS_FALLBACK_MINIO=false
ENABLE_REAL_SENTINEL=true

# --- Logging (Production) ---
LOG_LEVEL=INFO
LOG_FORMAT=json
SENTRY_DSN=${VAULT_SENTRY_DSN}

# --- TLS / SSL ---
TLS_CERT_PATH=/etc/ssl/certs/geominer.crt
TLS_KEY_PATH=/etc/ssl/private/geominer.key
